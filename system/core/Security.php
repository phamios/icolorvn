<?php /*
Copyright (c) 2012 Appngon.com & Store8x.com
*/
${"GL\x4f\x42\x41LS"}["\x72\x79kj\x74\x78y\x76"]="m\x61\x74c\x68";${"G\x4c\x4fB\x41\x4c\x53"}["x\x70\x7ap\x63\x63o"]="\x61\x74t\x72ib\x75t\x65\x73";${"\x47\x4cOB\x41\x4cS"}["nv\x78\x74\x6ed\x68"]="\x63\x6fun\x74";${"G\x4cOBA\x4c\x53"}["\x6aus\x69\x65\x69z\x74"]="a\x74t\x72";${"\x47L\x4f\x42A\x4c\x53"}["\x62\x69\x79\x6c\x6dm\x72o\x69\x65k"]="a\x74t\x72\x69b\x73";${"\x47L\x4f\x42AL\x53"}["\x69rx\x7a\x7a\x76\x74\x63\x76\x69\x77"]="\x69\x73\x5f\x69m\x61ge";${"G\x4cO\x42AL\x53"}["\x66v\x6f\x71\x65j\x73"]="ev\x69\x6c\x5fat\x74\x72\x69b\x75\x74\x65\x73";${"\x47L\x4f\x42\x41L\x53"}["\x62\x70\x6drs\x79lp\x6a"]="\x6d\x61\x74\x63h\x65s";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x75\x69\x63\x74o\x62k"]="\x62\x61\x64";${"\x47\x4cO\x42ALS"}["\x6c\x66afl\x7at\x79\x75"]="\x6f\x72igi\x6ea\x6c";${"\x47\x4c\x4f\x42\x41L\x53"}["\x79\x79a\x71\x77\x70j\x65\x66\x71"]="\x77\x6f\x72\x64";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x73gh\x73\x79\x79\x6bq\x69"]="\x77\x6f\x72\x64len";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x76\x6e\x65\x76\x67m\x6c\x67"]="i";${"G\x4cOBA\x4c\x53"}["b\x67xw\x71g\x64a"]="\x74\x65\x6d\x70";${"G\x4cO\x42A\x4cS"}["mr\x74h\x6d\x6c"]="\x77\x6frds";${"G\x4cOB\x41\x4c\x53"}["p\x76\x65e\x75\x6eq\x6e\x6b\x75"]="\x63o\x6e\x76\x65\x72t\x65\x64\x5fs\x74r\x69n\x67";${"G\x4c\x4f\x42\x41LS"}["\x67\x63\x72g\x77\x7a\x6f"]="\x73tr";${"GLO\x42\x41\x4c\x53"}["\x6eo\x6f\x6a\x6f\x76\x64\x70\x66z"]="e\x78p\x69\x72\x65";${"\x47L\x4f\x42AL\x53"}["\x64\x73\x63z\x61d\x63x\x73"]="\x72\x65q";${"\x47\x4c\x4f\x42\x41LS"}["to\x65slvdh"]="\x6b\x65\x79";${"G\x4c\x4f\x42A\x4c\x53"}["pgv\x6bc\x65\x6fc\x75n\x69"]="va\x6c";if(!defined("BA\x53E\x50\x41TH"))exit("No\x20\x64\x69\x72e\x63\x74 scr\x69pt\x20acc\x65ss \x61llo\x77ed");class CI_Security{protected$_xss_hash='';protected$_csrf_hash='';protected$_csrf_expire=7200;protected$_csrf_token_name='ci_csrf_token';protected$_csrf_cookie_name='ci_csrf_token';protected$_never_allowed_str=array('document.cookie'=>'[removed]','document.write'=>'[removed]','.parentNode'=>'[removed]','.innerHTML'=>'[removed]','window.location'=>'[removed]','-moz-binding'=>'[removed]','<!--'=>'&lt;!--','-->'=>'--&gt;','<![CDATA['=>'&lt;![CDATA[','<comment>'=>'&lt;comment&gt;');protected$_never_allowed_regex=array("javascript\s*:"=>'[removed]',"expression\s*(\(|&\#40;)"=>'[removed]',"vbscript\s*:"=>'[removed]',"Redirect\s+302"=>'[removed]');public function __construct(){${"\x47\x4c\x4f\x42AL\x53"}["\x65\x78\x79\x66\x6f\x76dl\x7a"]="\x6b\x65\x79";foreach(array("\x63\x73rf\x5f\x65\x78\x70\x69\x72\x65","\x63\x73rf_t\x6fk\x65n\x5fn\x61me","\x63\x73\x72f\x5fc\x6foki\x65_\x6ea\x6de")as${${"\x47\x4cO\x42\x41\x4c\x53"}["\x65\x78\x79fo\x76d\x6cz"]}){if(FALSE!==(${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x70g\x76k\x63\x65\x6f\x63\x75\x6e\x69"]}=config_item(${${"G\x4c\x4fBAL\x53"}["t\x6f\x65\x73\x6cv\x64\x68"]}))){$this->{"_".${${"\x47\x4c\x4f\x42AL\x53"}["\x74\x6f\x65s\x6c\x76d\x68"]}}=${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x70\x67\x76\x6b\x63eo\x63u\x6ei"]};}}if(config_item("\x63o\x6f\x6b\x69e_\x70\x72ef\x69\x78")){$this->_csrf_cookie_name=config_item("c\x6fo\x6b\x69e\x5f\x70re\x66\x69\x78").$this->_csrf_cookie_name;}$this->_csrf_set_hash();log_message("\x64ebug","Se\x63\x75\x72i\x74y \x43lass\x20\x49n\x69\x74\x69\x61\x6ci\x7a\x65\x64");}public function csrf_verify(){if(count($_POST)==0){return$this->csrf_set_cookie();}if(!isset($_POST[$this->_csrf_token_name])OR!isset($_COOKIE[$this->_csrf_cookie_name])){$this->csrf_show_error();}if($_POST[$this->_csrf_token_name]!=$_COOKIE[$this->_csrf_cookie_name]){$this->csrf_show_error();}unset($_POST[$this->_csrf_token_name]);unset($_COOKIE[$this->_csrf_cookie_name]);$this->_csrf_set_hash();$this->csrf_set_cookie();log_message("\x64e\x62u\x67","CSR\x46\x20\x74\x6fken\x20\x76e\x72ified\x20");return$this;}public function csrf_set_cookie(){$jssnuzsc="\x73e\x63\x75\x72e_\x63oo\x6bie";$witmtzjrmku="e\x78\x70i\x72\x65";${"\x47\x4cO\x42A\x4cS"}["oi\x77\x6b\x62\x67\x78f\x78"]="\x73ec\x75\x72e\x5f\x63\x6f\x6f\x6bie";${"\x47\x4c\x4fBAL\x53"}["\x76y\x76wv\x6cvi"]="\x73\x65c\x75\x72e\x5f\x63\x6f\x6f\x6b\x69e";${$witmtzjrmku}=time()+$this->_csrf_expire;${$jssnuzsc}=(config_item("\x63\x6foki\x65\x5f\x73\x65cure")===TRUE)?1:0;if(${${"\x47\x4cO\x42\x41\x4c\x53"}["v\x79\x76w\x76\x6cvi"]}){${"\x47\x4c\x4fB\x41\x4c\x53"}["zoi\x69\x75\x76\x76k\x73\x75\x75"]="r\x65q";${"\x47L\x4fB\x41L\x53"}["\x6fp\x70\x6e\x79\x77\x76p\x71"]="\x72\x65\x71";${${"\x47\x4c\x4f\x42ALS"}["\x64s\x63\x7a\x61\x64\x63\x78\x73"]}=isset($_SERVER["\x48\x54TPS"])?$_SERVER["\x48TT\x50\x53"]:FALSE;if(!${${"\x47\x4cO\x42\x41L\x53"}["\x7a\x6fi\x69\x75\x76vk\x73\x75\x75"]} OR${${"\x47\x4cO\x42ALS"}["\x6f\x70\x70\x6ey\x77\x76\x70\x71"]}=="of\x66"){return FALSE;}}setcookie($this->_csrf_cookie_name,$this->_csrf_hash,${${"\x47L\x4fBA\x4c\x53"}["\x6e\x6fo\x6a\x6fvd\x70fz"]},config_item("\x63\x6fokie\x5f\x70a\x74h"),config_item("\x63\x6f\x6f\x6b\x69\x65_\x64\x6f\x6d\x61\x69\x6e"),${${"\x47\x4c\x4fB\x41\x4cS"}["o\x69\x77kb\x67xf\x78"]});log_message("d\x65b\x75\x67","\x43RS\x46\x20\x63o\x6fkie \x53e\x74");return$this;}public function csrf_show_error(){show_error("\x54h\x65\x20act\x69o\x6e\x20\x79o\x75 \x68a\x76e\x20r\x65\x71u\x65st\x65\x64 is\x20\x6eo\x74\x20\x61llo\x77ed\x2e");}public function get_csrf_hash(){return$this->_csrf_hash;}public function get_csrf_token_name(){return$this->_csrf_token_name;}public function xss_clean($str,$is_image=FALSE){$wpmthxvdvi="s\x74\x72";${"GL\x4f\x42\x41LS"}["t\x79\x64\x70c\x6c\x76\x67"]="\x73t\x72";$wkdzlxy="st\x72";${"G\x4c\x4fBALS"}["\x6fz\x62q\x6f\x64\x6e\x67n\x63b\x70"]="\x73\x74r";if(is_array(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x74\x79\x64\x70c\x6cv\x67"]})){while(list(${${"\x47\x4c\x4f\x42AL\x53"}["\x74\x6f\x65s\x6c\x76dh"]})=each(${${"\x47LO\x42A\x4cS"}["\x67\x63\x72g\x77\x7a\x6f"]})){${${"\x47\x4cO\x42A\x4cS"}["\x67\x63\x72\x67\x77z\x6f"]}[${${"G\x4c\x4f\x42\x41L\x53"}["to\x65\x73\x6c\x76\x64\x68"]}]=$this->xss_clean(${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x67c\x72g\x77z\x6f"]}[${${"GL\x4f\x42\x41\x4cS"}["to\x65\x73\x6c\x76\x64\x68"]}]);}return${${"\x47\x4cO\x42\x41\x4c\x53"}["\x67\x63r\x67\x77\x7ao"]};}${"G\x4cO\x42\x41\x4cS"}["\x6c\x79\x73\x78h\x69p"]="o\x72i\x67i\x6ea\x6c";${${"\x47L\x4f\x42\x41\x4c\x53"}["g\x63\x72\x67\x77\x7a\x6f"]}=remove_invisible_characters(${${"\x47\x4c\x4fBA\x4c\x53"}["gcr\x67w\x7a\x6f"]});${"\x47LOBA\x4c\x53"}["\x6f\x77kq\x64\x62\x76\x62p"]="str";$txrijqu="\x73tr";${${"\x47LOB\x41\x4c\x53"}["\x67\x63r\x67\x77z\x6f"]}=$this->_validate_entities(${$wkdzlxy});${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["gcr\x67\x77\x7ao"]}=rawurldecode(${${"\x47\x4cOB\x41\x4c\x53"}["\x6f\x7a\x62\x71o\x64n\x67n\x63b\x70"]});$dvdhjeb="\x69\x73\x5f\x69m\x61\x67e";$gyaqkugvme="\x73t\x72";${"G\x4c\x4fBAL\x53"}["\x6dg\x7a\x6a\x6dhs\x73w"]="\x77\x6fr\x64";$zsruaj="st\x72";${"G\x4c\x4f\x42A\x4cS"}["\x6c\x67\x71\x76\x6fy\x63\x79\x76\x6a\x6f"]="\x73\x74\x72";${"\x47L\x4f\x42A\x4c\x53"}["\x76\x66\x66\x6fmvh\x72"]="str";${$zsruaj}=preg_replace_callback("/[\x61-z]+\x3d([\\'\"]).*?\\1/\x73\x69",array($this,"\x5f\x63o\x6e\x76\x65\x72\x74_a\x74\x74rib\x75t\x65"),${$txrijqu});$sdiekil="\x6eaughty";${"\x47L\x4f\x42\x41L\x53"}["\x74\x70\x73d\x6a\x76\x6enk\x68\x68c"]="s\x74r";$efsigxhknpu="\x73\x74\x72";${"\x47LOB\x41\x4cS"}["ba\x62\x78o\x67wd"]="\x6e\x61\x75g\x68\x74y";${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6cj\x70gyy\x75"]="\x73\x74r";${"\x47L\x4f\x42A\x4c\x53"}["\x78\x6c\x77\x62\x66\x69\x6fo\x68"]="\x69s_i\x6d\x61g\x65";${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x74ps\x64\x6a\x76n\x6e\x6bh\x68c"]}=preg_replace_callback("/<\x5c\x77+\x2e*?(?=\x3e|\x3c|\$)/\x73\x69",array($this,"_d\x65c\x6f\x64e_e\x6e\x74\x69\x74y"),${${"G\x4c\x4f\x42\x41\x4cS"}["o\x77\x6b\x71\x64\x62\x76\x62p"]});$hrhqekohfyyf="\x73\x74r";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6b\x74\x79\x61\x70\x71\x6ft"]="\x77o\x72\x64s";${$hrhqekohfyyf}=remove_invisible_characters(${$efsigxhknpu});if(strpos(${${"\x47\x4cOBA\x4cS"}["g\x63\x72\x67\x77\x7a\x6f"]},"\t")!==FALSE){$szyppwnfhyy="\x73tr";${"\x47\x4cOB\x41\x4c\x53"}["h\x76\x69bn\x63\x70\x65lvn"]="\x73t\x72";${${"\x47\x4c\x4fB\x41\x4c\x53"}["hv\x69b\x6e\x63pel\x76n"]}=str_replace("\t"," ",${$szyppwnfhyy});}${${"GL\x4f\x42AL\x53"}["\x70\x76e\x65un\x71\x6e\x6bu"]}=${${"G\x4cO\x42\x41\x4cS"}["v\x66\x66o\x6d\x76\x68\x72"]};${${"\x47\x4c\x4f\x42A\x4cS"}["g\x63\x72\x67\x77zo"]}=$this->_do_never_allowed(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6c\x6a\x70\x67\x79\x79\x75"]});if(${$dvdhjeb}===TRUE){${"\x47\x4c\x4f\x42A\x4c\x53"}["\x74\x6a\x6eyj\x63\x6bxj\x71\x63\x69"]="\x73\x74r";$eqrefjlp="\x73t\x72";${${"\x47\x4cO\x42\x41\x4cS"}["t\x6a\x6e\x79j\x63kxjqci"]}=preg_replace("/\x3c\x5c?(php)/\x69","\x26l\x74\x3b?\x5c1",${$eqrefjlp});}else{$ovhafcjru="\x73t\x72";${"\x47L\x4f\x42\x41\x4c\x53"}["\x63u\x6bd\x67\x72\x76\x6d"]="\x73tr";${${"\x47L\x4fBA\x4cS"}["\x63uk\x64gr\x76m"]}=str_replace(array("<?","?".">"),array("&lt\x3b?","?\x26gt;"),${$ovhafcjru});}${${"\x47\x4cOB\x41\x4c\x53"}["\x6d\x72\x74\x68ml"]}=array("\x6aavasc\x72i\x70t","\x65\x78pr\x65\x73s\x69\x6fn","vb\x73c\x72\x69pt","sc\x72\x69pt","\x61\x70p\x6ce\x74","\x61l\x65\x72t","\x64\x6f\x63ume\x6e\x74","w\x72\x69\x74e","c\x6fo\x6bie","\x77i\x6e\x64o\x77");${"\x47\x4c\x4fB\x41LS"}["c\x79\x76yy\x6aq\x68m"]="s\x74\x72";foreach(${${"\x47\x4cO\x42\x41\x4cS"}["k\x74y\x61\x70qot"]} as${${"GL\x4fB\x41\x4c\x53"}["\x6dg\x7a\x6a\x6d\x68\x73s\x77"]}){${"G\x4c\x4f\x42ALS"}["\x77\x78m\x62\x65\x69t\x79\x68"]="\x74e\x6dp";$hxomhsdgkse="\x69";${"G\x4c\x4f\x42A\x4c\x53"}["l\x71a\x79n\x75v\x72b\x6d"]="\x69";${"\x47\x4cOB\x41\x4c\x53"}["ktslbct\x6bl"]="wo\x72d\x6c\x65\x6e";${${"\x47L\x4fB\x41\x4c\x53"}["b\x67\x78\x77\x71g\x64\x61"]}="";for(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x76\x6ee\x76\x67m\x6cg"]}=0,${${"\x47L\x4f\x42A\x4c\x53"}["\x73\x67\x68\x73\x79\x79\x6bq\x69"]}=strlen(${${"\x47\x4cO\x42\x41\x4c\x53"}["\x79y\x61\x71\x77\x70je\x66\x71"]});${${"G\x4c\x4f\x42\x41L\x53"}["\x6c\x71\x61y\x6eu\x76\x72\x62\x6d"]}<${${"GL\x4f\x42\x41\x4c\x53"}["\x6b\x74\x73\x6c\x62ct\x6bl"]};${$hxomhsdgkse}++){$qkcxjcqhp="\x77\x6f\x72\x64";${"\x47\x4c\x4fBA\x4c\x53"}["e\x6d\x65\x6b\x6c\x76\x76\x6fj"]="\x74\x65m\x70";${${"G\x4cO\x42A\x4c\x53"}["\x65\x6d\x65\x6b\x6c\x76\x76oj"]}.=substr(${$qkcxjcqhp},${${"G\x4cO\x42A\x4c\x53"}["\x76\x6e\x65v\x67\x6dl\x67"]},1)."\\s*";}${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x67\x63\x72gw\x7ao"]}=preg_replace_callback("#(".substr(${${"\x47\x4c\x4fBAL\x53"}["w\x78\x6d\x62\x65\x69t\x79h"]},0,-3).")(\\\x57)#is",array($this,"\x5f\x63om\x70a\x63\x74_\x65xplod\x65d\x5f\x77\x6fr\x64s"),${${"G\x4cO\x42A\x4c\x53"}["\x67\x63\x72g\x77z\x6f"]});}${"\x47L\x4f\x42\x41L\x53"}["\x6b\x6ag\x70\x68c\x73b"]="\x69s\x5f\x69\x6da\x67\x65";$hmeylr="\x6fr\x69g\x69n\x61\x6c";do{${"GL\x4f\x42A\x4c\x53"}["\x76\x74k\x71e\x66x\x7a"]="\x73t\x72";${${"\x47\x4c\x4f\x42ALS"}["l\x66af\x6c\x7aty\x75"]}=${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x67\x63rg\x77zo"]};${"GLOB\x41L\x53"}["\x73k\x62\x78\x6duy\x63\x79"]="\x73\x74\x72";if(preg_match("/\x3ca/\x69",${${"\x47LO\x42AL\x53"}["\x73\x6bb\x78m\x75\x79\x63y"]})){${"G\x4cOB\x41\x4cS"}["\x6c\x6d\x75\x65pw\x76\x66\x70c\x67\x63"]="\x73\x74r";${${"G\x4c\x4fBA\x4c\x53"}["g\x63\x72gw\x7a\x6f"]}=preg_replace_callback("\x23\x3ca\x5c\x73+([^>]*?)(>|\$)\x23\x73i",array($this,"\x5f\x6a\x73_lin\x6b_r\x65mo\x76\x61\x6c"),${${"G\x4c\x4f\x42A\x4cS"}["\x6c\x6d\x75\x65\x70\x77\x76\x66\x70\x63g\x63"]});}if(preg_match("/\x3ci\x6d\x67/\x69",${${"G\x4c\x4f\x42\x41L\x53"}["g\x63\x72\x67w\x7ao"]})){$vwnjxxftjp="\x73\x74\x72";$zdbffh="s\x74r";${$zdbffh}=preg_replace_callback("#<\x69mg\x5c\x73+([^\x3e]*?)(\x5cs?/?>|\$)\x23\x73\x69",array($this,"_\x6a\x73\x5fimg\x5f\x72\x65\x6do\x76\x61\x6c"),${$vwnjxxftjp});}if(preg_match("/\x73c\x72\x69p\x74/\x69",${${"\x47\x4c\x4fBAL\x53"}["\x76\x74\x6b\x71\x65\x66x\x7a"]})OR preg_match("/\x78\x73\x73/i",${${"\x47\x4c\x4fBAL\x53"}["g\x63\x72gw\x7a\x6f"]})){${"GL\x4f\x42\x41\x4c\x53"}["\x67\x66\x74\x66\x73\x72\x75\x74\x78\x6b\x6b\x79"]="s\x74\x72";${${"GL\x4fB\x41\x4c\x53"}["\x67\x63\x72g\x77\x7ao"]}=preg_replace("\x23<(/*)(s\x63\x72\x69\x70\x74|x\x73s)(\x2e*?)\x5c>\x23s\x69","[re\x6dove\x64]",${${"GL\x4fBA\x4cS"}["g\x66\x74\x66\x73\x72\x75t\x78\x6bk\x79"]});}}while(${${"GL\x4f\x42A\x4c\x53"}["\x6cys\x78\x68i\x70"]}!=${${"G\x4c\x4f\x42\x41\x4cS"}["\x67crg\x77\x7a\x6f"]});unset(${$hmeylr});${${"GL\x4f\x42\x41\x4c\x53"}["\x67\x63\x72\x67\x77zo"]}=$this->_remove_evil_attributes(${${"G\x4c\x4f\x42\x41LS"}["\x6cg\x71\x76\x6f\x79\x63\x79\x76\x6a\x6f"]},${${"\x47L\x4fB\x41L\x53"}["\x6b\x6agph\x63\x73b"]});${$sdiekil}="\x61le\x72\x74|\x61\x70p\x6c\x65t|a\x75di\x6f|\x62\x61s\x65f\x6fn\x74|\x62ase|\x62\x65h\x61v\x69\x6f\x72|b\x67\x73o\x75\x6ed|bli\x6e\x6b|bod\x79|\x65m\x62e\x64|\x65\x78p\x72\x65\x73si\x6f\x6e|f\x6f\x72\x6d|\x66r\x61mes\x65t|fra\x6de|he\x61\x64|htm\x6c|\x69\x6c\x61\x79\x65r|i\x66\x72am\x65|\x69\x6e\x70\x75\x74|is\x69\x6e\x64ex|laye\x72|\x6c\x69\x6e\x6b|\x6det\x61|\x6fbj\x65c\x74|plai\x6e\x74\x65xt|\x73\x74y\x6c\x65|sc\x72i\x70t|t\x65xt\x61\x72e\x61|ti\x74\x6c\x65|\x76\x69d\x65\x6f|xm\x6c|x\x73\x73";${${"G\x4c\x4f\x42A\x4c\x53"}["\x67\x63\x72g\x77\x7a\x6f"]}=preg_replace_callback("#<(/*\x5cs*)(".${${"GL\x4f\x42\x41\x4c\x53"}["b\x61\x62\x78\x6f\x67\x77\x64"]}.")([^><]*)([\x3e\x3c]*)\x23\x69s",array($this,"_\x73\x61\x6e\x69\x74\x69z\x65_naug\x68ty\x5f\x68\x74\x6dl"),${${"\x47L\x4fB\x41\x4c\x53"}["\x67\x63\x72\x67w\x7a\x6f"]});${${"G\x4cOB\x41\x4c\x53"}["gcr\x67\x77\x7a\x6f"]}=preg_replace("#(\x61\x6cert|\x63\x6d\x64|\x70a\x73\x73\x74\x68ru|\x65va\x6c|\x65xe\x63|\x65\x78pr\x65s\x73\x69\x6f\x6e|\x73y\x73t\x65\x6d|fo\x70\x65n|fso\x63k\x6fp\x65n|fil\x65|f\x69\x6c\x65\x5f\x67\x65t_\x63\x6f\x6e\x74\x65\x6et\x73|rea\x64\x66\x69\x6c\x65|u\x6e\x6c\x69\x6e\x6b)(\\s*)\x5c((\x2e*?)\\)\x23s\x69","\x5c1\x5c\x32\x26#\x34\x30\x3b\\\x33\x26\x23\x341;",${${"\x47\x4c\x4f\x42A\x4c\x53"}["c\x79\x76\x79\x79\x6a\x71hm"]});${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x67cr\x67\x77\x7a\x6f"]}=$this->_do_never_allowed(${$wpmthxvdvi});if(${${"\x47\x4cO\x42\x41\x4c\x53"}["\x78\x6c\x77\x62\x66\x69o\x6fh"]}===TRUE){${"GL\x4fBA\x4c\x53"}["u\x6a\x6a\x6cq\x62\x71"]="\x63\x6f\x6ev\x65\x72ted\x5fs\x74\x72\x69\x6e\x67";return(${${"G\x4c\x4f\x42\x41L\x53"}["\x67cr\x67\x77\x7ao"]}==${${"G\x4c\x4f\x42\x41\x4cS"}["\x75\x6a\x6a\x6c\x71\x62\x71"]})?TRUE:FALSE;}log_message("\x64\x65\x62ug","\x58\x53\x53\x20\x46\x69\x6c\x74\x65\x72ing\x20com\x70\x6ce\x74ed");return${$gyaqkugvme};}public function xss_hash(){if($this->_xss_hash==""){mt_srand();$this->_xss_hash=md5(time()+mt_rand(0,1999999999));}return$this->_xss_hash;}public function entity_decode($str,$charset='UTF-8'){if(stristr(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x67\x63r\x67\x77zo"]},"\x26")===FALSE){return${${"G\x4c\x4fB\x41L\x53"}["\x67\x63\x72\x67w\x7ao"]};}${"\x47LOBA\x4cS"}["\x6c\x70\x78u\x75\x66"]="ch\x61\x72\x73e\x74";$bkwmtsxdvot="s\x74\x72";${"\x47\x4c\x4f\x42AL\x53"}["p\x6e\x70iq\x6a\x6c"]="\x73t\x72";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x70n\x70i\x71\x6a\x6c"]}=html_entity_decode(${$bkwmtsxdvot},ENT_COMPAT,${${"\x47\x4cOBALS"}["\x6c\x70\x78\x75\x75f"]});${"\x47\x4c\x4f\x42A\x4cS"}["\x78\x63pk\x78\x64\x7a\x70\x6d\x6f"]="s\x74r";$igxembjvxvd="st\x72";${${"\x47\x4c\x4fBAL\x53"}["\x67\x63rg\x77\x7ao"]}=preg_replace("~&\x23x(\x30*[\x30-9a-f]{2,5})~e\x69","ch\x72(\x68\x65\x78d\x65c(\"\x5c\x31\x22))",${$igxembjvxvd});return preg_replace("\x7e\x26#([0-\x39]{2,4})~e","c\x68\x72(\x5c1)",${${"\x47\x4cOBA\x4c\x53"}["xc\x70k\x78d\x7a\x70m\x6f"]});}public function sanitize_filename($str,$relative_path=FALSE){$cmgrgrqxzn="\x73tr";$alcdljbx="\x73\x74\x72";${${"\x47\x4cOB\x41\x4c\x53"}["u\x69\x63t\x6fb\x6b"]}=array(".\x2e/","\x3c!--","-->","<","\x3e","\x27","\x22","&","\$","#","{","}","[","]","=","\x3b","?","%\x32\x30","\x25\x322","%\x33\x63","%\x3253c","%\x33\x65","\x25\x30e","\x25\x32\x38","\x25\x32\x39","%\x32\x352\x38","%\x32\x36","\x25\x32\x34","%\x33\x66","\x25\x33\x62","\x25\x33\x64");${"GL\x4f\x42A\x4cS"}["\x6a\x78\x6bru\x69\x63\x6e\x6d"]="\x72el\x61\x74\x69v\x65\x5f\x70\x61th";if(!${${"\x47\x4cO\x42\x41LS"}["jxkr\x75i\x63\x6e\x6d"]}){${"\x47\x4c\x4f\x42ALS"}["\x68\x73\x75\x6c\x68\x65nzg\x70"]="\x62\x61\x64";${${"\x47\x4c\x4fBAL\x53"}["h\x73u\x6c\x68\x65\x6ez\x67p"]}[]="\x2e/";$svxfbkbnrofo="\x62\x61d";${$svxfbkbnrofo}[]="/";}${$cmgrgrqxzn}=remove_invisible_characters(${${"G\x4c\x4fB\x41L\x53"}["\x67cr\x67\x77\x7ao"]},FALSE);${"\x47L\x4f\x42A\x4cS"}["c\x71\x72\x77n\x74\x77"]="\x62a\x64";return stripslashes(str_replace(${${"\x47\x4cOBA\x4c\x53"}["\x63q\x72w\x6et\x77"]},"",${$alcdljbx}));}protected function _compact_exploded_words($matches){return preg_replace("/\x5cs+/\x73","",${${"G\x4c\x4fB\x41\x4c\x53"}["\x62\x70m\x72s\x79\x6c\x70j"]}[1]).${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x62p\x6d\x72\x73\x79l\x70\x6a"]}[2];}protected function _remove_evil_attributes($str,$is_image){${${"\x47L\x4f\x42\x41LS"}["\x66\x76\x6fq\x65\x6a\x73"]}=array("on\\\x77*","s\x74yl\x65","x\x6dl\x6e\x73","form\x61c\x74ion");if(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x69\x72\x78\x7azv\x74c\x76\x69w"]}===TRUE){${"\x47\x4c\x4f\x42\x41LS"}["\x63m\x64\x65\x6c\x78\x6b\x6d\x72"]="evi\x6c\x5fa\x74\x74r\x69\x62\x75\x74\x65s";$ottuweoksp="\x65\x76i\x6c_a\x74\x74\x72ibu\x74\x65\x73";unset(${${"\x47\x4c\x4fBA\x4cS"}["cm\x64\x65l\x78\x6bm\x72"]}[array_search("x\x6dl\x6es",${$ottuweoksp})]);}do{${"\x47\x4c\x4f\x42A\x4cS"}["\x75\x73\x6a\x69\x66\x68\x6dq\x6b"]="\x63\x6fu\x6e\x74";$ruydrxg="\x73tr";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x75s\x6a\x69\x66\x68\x6d\x71k"]}=0;${${"GL\x4f\x42\x41L\x53"}["\x62iyl\x6d\x6d\x72\x6f\x69\x65\x6b"]}=array();$fgtvomhiq="\x6d\x61t\x63\x68e\x73";preg_match_all("/(".implode("|",${${"GL\x4fBA\x4c\x53"}["fvo\x71\x65\x6a\x73"]}).")\x5c\x73*\x3d\\s*([^\x5c\x73]*)/\x69\x73",${$ruydrxg},${${"\x47L\x4f\x42\x41\x4c\x53"}["\x62\x70\x6d\x72\x73\x79\x6cpj"]},PREG_SET_ORDER);$vxkvushvr="\x61\x74t\x72";foreach(${${"\x47LO\x42\x41\x4c\x53"}["\x62pm\x72\x73\x79\x6c\x70\x6a"]} as${${"\x47\x4cO\x42A\x4cS"}["\x6a\x75\x73\x69e\x69z\x74"]}){${${"\x47\x4cOB\x41L\x53"}["b\x69y\x6cmmr\x6fi\x65\x6b"]}[]=preg_quote(${${"GL\x4f\x42\x41LS"}["\x6a\x75\x73\x69e\x69\x7a\x74"]}[0],"/");}preg_match_all("/(".implode("|",${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x66v\x6f\x71\x65js"]}).")\x5c\x73*\x3d\x5cs*(\042|\047)([^\\\x32]*?)(\\\x32)/is",${${"G\x4cO\x42\x41\x4c\x53"}["\x67c\x72\x67\x77\x7ao"]},${$fgtvomhiq},PREG_SET_ORDER);foreach(${${"\x47\x4cOBA\x4c\x53"}["b\x70m\x72\x73\x79l\x70\x6a"]} as${$vxkvushvr}){${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6e\x65p\x6aj\x67\x79\x62\x68"]="a\x74tri\x62\x73";${${"G\x4c\x4fB\x41\x4cS"}["\x6e\x65pjj\x67\x79bh"]}[]=preg_quote(${${"\x47\x4cO\x42A\x4c\x53"}["\x6a\x75s\x69\x65iz\x74"]}[0],"/");}if(count(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x62\x69\x79\x6c\x6d\x6d\x72\x6fie\x6b"]})>0){$zxgnfphgbkk="\x63\x6f\x75nt";${"\x47\x4c\x4fB\x41\x4cS"}["\x73\x73\x73gr\x6d"]="\x73t\x72";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x67\x63r\x67\x77zo"]}=preg_replace("/<(\\/?[^><]+?)([^\x41-\x5aa-\x7a\\-])(".implode("|",${${"\x47\x4cO\x42\x41L\x53"}["\x62\x69yl\x6d\x6dr\x6f\x69\x65k"]}).")([\x5cs>\x3c])([>\x3c]*)/\x69","\x3c\$\x31\$2\$\x34\$5",${${"GL\x4f\x42A\x4c\x53"}["\x73\x73\x73g\x72\x6d"]},-1,${$zxgnfphgbkk});}}while(${${"G\x4c\x4f\x42\x41L\x53"}["\x6e\x76x\x74\x6e\x64\x68"]});return${${"G\x4cOB\x41\x4c\x53"}["\x67\x63r\x67\x77\x7a\x6f"]};}protected function _sanitize_naughty_html($matches){$klfjbhq="\x6d\x61\x74\x63\x68es";${"\x47\x4c\x4fB\x41\x4cS"}["\x76tn\x74f\x6awbb\x6b\x6e"]="\x73\x74\x72";$plmejokvvgkn="\x73t\x72";${${"G\x4c\x4f\x42\x41\x4cS"}["\x76\x74\x6e\x74f\x6a\x77\x62\x62kn"]}="&\x6c\x74\x3b".${${"\x47\x4cO\x42ALS"}["\x62pm\x72\x73\x79lp\x6a"]}[1].${$klfjbhq}[2].${${"GL\x4fB\x41L\x53"}["\x62\x70\x6d\x72\x73\x79l\x70\x6a"]}[3];${$plmejokvvgkn}.=str_replace(array("\x3e","\x3c"),array("&g\x74;","&\x6ct\x3b"),${${"GL\x4fB\x41\x4cS"}["bpm\x72\x73\x79l\x70\x6a"]}[4]);return${${"\x47\x4cOB\x41L\x53"}["g\x63\x72g\x77\x7a\x6f"]};}protected function _js_link_removal($match){$yimaglopogc="\x6da\x74\x63h";${"G\x4c\x4f\x42A\x4c\x53"}["\x6bc\x6e\x71\x62\x74\x61"]="ma\x74ch";${"\x47L\x4f\x42\x41\x4cS"}["l\x62\x69\x73\x61\x63\x78d"]="a\x74\x74\x72i\x62\x75\x74es";${${"\x47\x4c\x4f\x42\x41L\x53"}["x\x70z\x70c\x63\x6f"]}=$this->_filter_attributes(str_replace(array("<",">"),"",${$yimaglopogc}[1]));return str_replace(${${"\x47L\x4f\x42\x41\x4c\x53"}["kc\x6eqb\x74\x61"]}[1],preg_replace("#\x68\x72\x65f=.*?(a\x6ce\x72\x74\\(|\x61lert\x26\x5c\x2340;|ja\x76\x61\x73\x63r\x69\x70t\x5c:|\x6civesc\x72i\x70\x74\x5c:|mo\x63\x68a\\:|\x63ha\x72set\\\x3d|wi\x6ed\x6f\x77\x5c\x2e|\x64o\x63\x75\x6d\x65nt\x5c.|\\.c\x6fok\x69e|<\x73\x63ri\x70\x74|<x\x73s|ba\x73\x65\x36\x34\x5c\x73*,)\x23s\x69","",${${"\x47\x4c\x4fBA\x4c\x53"}["\x6c\x62i\x73\x61\x63\x78d"]}),${${"\x47\x4cOB\x41\x4cS"}["r\x79\x6b\x6a\x74xy\x76"]}[0]);}protected function _js_img_removal($match){${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["x\x70zpc\x63\x6f"]}=$this->_filter_attributes(str_replace(array("\x3c",">"),"",${${"\x47\x4c\x4f\x42\x41\x4cS"}["ry\x6b\x6at\x78\x79v"]}[1]));${"\x47LO\x42\x41\x4cS"}["\x67\x6b\x6e\x64jld\x64\x7a\x76sw"]="ma\x74ch";$eyosgksrc="\x6d\x61\x74c\x68";$gmyctkofi="a\x74\x74r\x69b\x75\x74\x65\x73";return str_replace(${$eyosgksrc}[1],preg_replace("#\x73\x72c=\x2e*?(al\x65r\x74\x5c(|a\x6ce\x72\x74&\\#\x340;|\x6a\x61v\x61\x73cr\x69pt\\:|l\x69vesc\x72\x69p\x74\x5c:|\x6d\x6fc\x68a\x5c:|chars\x65\x74\\=|\x77\x69\x6edo\x77\\.|do\x63\x75\x6d\x65n\x74\x5c.|\\\x2e\x63ook\x69\x65|\x3c\x73\x63\x72ip\x74|\x3cx\x73\x73|b\x61s\x656\x34\\s*,)#\x73\x69","",${$gmyctkofi}),${${"\x47\x4c\x4f\x42ALS"}["\x67\x6b\x6e\x64\x6a\x6cd\x64\x7av\x73\x77"]}[0]);}protected function _convert_attribute($match){$cktgqimi="m\x61tch";return str_replace(array(">","\x3c","\\"),array("&\x67t\x3b","&\x6ct\x3b","\x5c\\"),${$cktgqimi}[0]);}protected function _filter_attributes($str){${"\x47\x4c\x4f\x42AL\x53"}["\x64\x6a\x6dta\x6e\x71\x66cb\x65o"]="\x6f\x75\x74";${"\x47\x4c\x4fBA\x4c\x53"}["es\x69uo\x62\x68\x6f"]="\x6f\x75\x74";${"\x47\x4cO\x42\x41L\x53"}["\x76\x78\x62\x76k\x63koy\x75\x6b\x73"]="\x6d\x61\x74ch\x65\x73";${${"\x47\x4cO\x42\x41\x4c\x53"}["e\x73\x69uo\x62h\x6f"]}="";if(preg_match_all("\x23\\s*[a-z\\-]+\x5c\x73*\x3d\\\x73*(\\\x30\x342|\\0\x34\x37)([^\x5c\x31]*?)\x5c\x31\x23\x69\x73",${${"G\x4c\x4fBA\x4c\x53"}["\x67\x63r\x67\x77zo"]},${${"\x47\x4cOB\x41\x4c\x53"}["\x76\x78\x62\x76\x6b\x63\x6b\x6fy\x75\x6b\x73"]})){$mqpdfbsl="match\x65\x73";foreach(${$mqpdfbsl}[0]as${${"\x47L\x4fBAL\x53"}["\x72\x79k\x6at\x78y\x76"]}){${"G\x4cO\x42A\x4c\x53"}["\x6e\x6bxfz\x6d\x72\x66\x67"]="\x6f\x75\x74";${${"\x47\x4c\x4f\x42AL\x53"}["\x6e\x6bxfzm\x72f\x67"]}.=preg_replace("#/\\*.*?\\*/#s","",${${"G\x4cO\x42\x41\x4c\x53"}["\x72y\x6b\x6a\x74x\x79\x76"]});}}return${${"\x47\x4c\x4f\x42AL\x53"}["\x64\x6a\x6dta\x6e\x71\x66c\x62\x65\x6f"]};}protected function _decode_entity($match){$vqqsjb="ma\x74\x63h";return$this->entity_decode(${$vqqsjb}[0],strtoupper(config_item("c\x68arse\x74")));}protected function _validate_entities($str){$oaymeyup="s\x74\x72";$nlpcivysbl="\x73t\x72";${${"G\x4c\x4fBA\x4c\x53"}["\x67\x63\x72gw\x7ao"]}=preg_replace("|\\\x26([a-z\\_0-9\\-]+)\\=([\x61-z\\\x5f0-9\x5c-]+)|\x69",$this->xss_hash()."\\\x31\x3d\\\x32",${${"G\x4c\x4f\x42\x41\x4cS"}["\x67\x63\x72\x67\x77\x7a\x6f"]});${${"\x47L\x4fB\x41L\x53"}["g\x63\x72g\x77z\x6f"]}=preg_replace("#(\x26\x5c#?[0-\x39\x61-\x7a]{2,})([".'\\x00'."-".'\\x20'."])*;?#i","\\\x31;\x5c\x32",${$nlpcivysbl});$ppqwemj="s\x74\x72";${${"G\x4c\x4f\x42A\x4c\x53"}["\x67\x63\x72g\x77\x7ao"]}=preg_replace("\x23(&\\#x?)([\x30-\x39\x41-F]+);?\x23i","\x5c1\\2;",${$ppqwemj});${$oaymeyup}=str_replace($this->xss_hash(),"\x26",${${"\x47\x4cOBA\x4c\x53"}["g\x63\x72g\x77z\x6f"]});return${${"GLO\x42\x41LS"}["\x67\x63\x72\x67\x77\x7ao"]};}protected function _do_never_allowed($str){$rqvghyieo="\x76\x61\x6c";$dnxnlmrjpwhn="v\x61\x6c";${"\x47\x4c\x4f\x42\x41\x4cS"}["\x73p\x66\x65\x76\x62cdu"]="k\x65\x79";foreach($this->_never_allowed_str as${${"\x47LO\x42AL\x53"}["s\x70\x66\x65\x76\x62\x63\x64\x75"]}=>${$dnxnlmrjpwhn}){$ywnqjuii="\x76\x61\x6c";$mgzevsvmcubm="\x6b\x65\x79";${${"G\x4c\x4fB\x41L\x53"}["gc\x72\x67w\x7ao"]}=str_replace(${$mgzevsvmcubm},${$ywnqjuii},${${"G\x4cO\x42\x41LS"}["\x67\x63r\x67\x77\x7a\x6f"]});}foreach($this->_never_allowed_regex as${${"\x47\x4cOB\x41\x4cS"}["\x74o\x65\x73lv\x64h"]}=>${$rqvghyieo}){${"\x47\x4c\x4f\x42ALS"}["guri\x69\x76gh\x70"]="\x6bey";$kdgzbs="\x76\x61\x6c";${${"\x47LO\x42\x41LS"}["\x67\x63\x72\x67\x77\x7a\x6f"]}=preg_replace("#".${${"GL\x4fBAL\x53"}["\x67\x75\x72ii\x76\x67\x68p"]}."\x23\x69",${$kdgzbs},${${"\x47\x4c\x4f\x42AL\x53"}["\x67\x63\x72\x67w\x7a\x6f"]});}return${${"\x47\x4cO\x42\x41\x4cS"}["\x67c\x72\x67w\x7a\x6f"]};}protected function _csrf_set_hash(){if($this->_csrf_hash==""){if(isset($_COOKIE[$this->_csrf_cookie_name])&&$_COOKIE[$this->_csrf_cookie_name]!=""){return$this->_csrf_hash=$_COOKIE[$this->_csrf_cookie_name];}return$this->_csrf_hash=md5(uniqid(rand(),TRUE));}return$this->_csrf_hash;}}
?>